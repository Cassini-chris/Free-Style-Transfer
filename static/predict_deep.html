<!DOCTYPE html>
<html lang="en">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Query is needed for the $.post method -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Free Style Transfer</title>

  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">

<script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5f84a4871baab900121c0ccf&product=inline-share-buttons" async="async"></script>
</head>

<body>

  <!-- MASTHEAD STYLE -->
  <style media="screen">
    .masthead {
      height: 100vh;
      min-height: 500px;
      background-image: url('https://storage.googleapis.com/epicml/4.jpg');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
  </style>

  <!-- HEADINGS STYLE -->
  <style media="screen">
    /*BIG */
    @media screen and (min-width: 601px) {
      #headline_text {
        font-size: 80px;
      }

      .list-inline-item {
        padding: 6px;
      }
    }

    /* SMALL */
    @media screen and (max-width: 600px) {
      #headline_text {
        font-size: 42px;
      }

      .list-inline-item {
        padding: 1px;
      }
    }
  </style>

  <header class="masthead">
    <div class="container h-100">
      <div class="row h-100 align-items-center">
        <div class="col-12 text-center">
          <h1 style="font-size:100px; color:white" class="font-weight-light">Free Style Transfer</h1>
          <p class="lead" style="color:white">Machine Learning Art based on TensorFlow</p>
        </div>
      </div>
    </div>
  </header>

  <!-- NAVIGATION -->
  <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <a class="navbar-brand" href="#">FreeStyleTransfer</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="https://epicml.net">EpicML</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.tensorflow.org/tutorials/generative/style_transfer">TensoFlow Style Transfer</a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- FIRST CONTENT -->
  <div id="upload" style="background-image: url('/static/images/pexel.jpg')" style="height:auto; width:auto; display:flex">
    <div class="container">

      <div class="row" style="margin:10px" style="background-image: url('/static/images/pexel.jpg')">
        <div class="col" style="text-align:center">
          <h1 class="display-2" id="headline_text" style="padding-top:15px">Try it yourself!</h1>
        </div>
      </div>

      <div class="row" style="max-width: 730px; margin:auto">
        <div class="col" style="text-align:center;">
          <label for="image-selector" class="btn btn-primary btn-lg" onclick="LoadFunction()">
            <input type="file" id="image-selector" style="display:none">Upload image</button>
          </label>

          <!-- SHOW UPLOADED IMAGE -->
          <script>
            var image_loaded;
            image_loaded = 0;

            function LoadFunction() {
              document.getElementById('uploaded_image_view').style.display = "block";
              image_loaded = 1;
            }
          </script>

          <div id="uploaded_image_view" class="row" style="padding:1px; text-align: center;  margin:auto; width:252px; padding-bottom:20px; display:none">
            <div class="column" style="padding:1px; text-align:center; margin:auto; width:250px; box-shadow:2px 4px 8px 2px rgba(0, 0, 0, 0.2); text-align: center">
              <img id="selected-image" src="" style="width:100%; margin-left:auto; margin-right:auto" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SECOND CONTENT -->
  <div class="container">
    <div class="row" style="margin:10px">
      <div class="col" style="text-align:center">
        <h1 class="display-2 mast_title" id="headline_text">Choose your Style</h1>
      </div>
    </div>

    <div class="row">

      <style media="screen">
        #myCarousel .list-inline {
          white-space: nowrap;
          overflow-x: auto;
        }

        #myCarousel .carousel-indicators {
          position: static;
          left: initial;
          width: initial;
          margin-left: initial;
        }

        #myCarousel .carousel-indicators>li {
          width: initial;
          height: initial;
          text-indent: initial;
        }

        #myCarousel .carousel-indicators>li.active img {
          opacity: 0.7;
        }

        .box {
          width: 100%;
          height: 300px;
        }

        .thumb_box {
          width: 175px;
          height: 50px;
        }
      </style>

      <div class="container py-2">
        <div class="row align-items-center">
          <div class="col-lg-8 offset-lg-2" id="slider">
            <div class="col" style="text-align:center; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">
              <label for="style_selector"><span id="own_style_text">Upload your own Style or choose one below:</span>
                <input id="style_selector" type="file" style="display:none">
                <img id="selected_style" src="https://getdrawings.com/free-icon-bw/upload-icon-png-11.png" class="img-fluid polaroid" style="height:75px; margin-top:4px " />
              </label>
            </div>
            <div  id="own_style_box" class="col" style="text-align:center; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); margin-bottom:20px;display:none">




                <img id="selected_style2" src="https://getdrawings.com/free-icon-bw/upload-icon-png-11.png" class="img-fluid polaroid" style="height:300px; margin-top:4px; padding:10px;" />

            </div>






            <div id="myCarousel" class="carousel slide shadow">
              <!-- main slider carousel items -->
              <div class="carousel-inner">

                <div class="active carousel-item" data-slide-number="0">
                  <img src="https://storage.googleapis.com/epicml/1.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="1">
                  <img src="https://storage.googleapis.com/epicml/2.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="2">
                  <img src="https://storage.googleapis.com/epicml/3.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="3">
                  <img src="https://storage.googleapis.com/epicml/4.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="4">
                  <img src="https://storage.googleapis.com/epicml/5.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="5">
                  <img src="https://storage.googleapis.com/epicml/6.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="6">
                  <img src="https://storage.googleapis.com/epicml/7.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="7">
                  <img src="https://storage.googleapis.com/epicml/8.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="8">
                  <img src="https://storage.googleapis.com/epicml/9.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="9">
                  <img src="https://storage.googleapis.com/epicml/10.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="10">
                  <img src="https://storage.googleapis.com/epicml/11.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="11">
                  <img src="https://storage.googleapis.com/epicml/12.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="12">
                  <img src="https://storage.googleapis.com/epicml/13.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="13">
                  <img src="https://storage.googleapis.com/epicml/14.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="14">
                  <img src="https://storage.googleapis.com/epicml/15.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="15">
                  <img src="https://storage.googleapis.com/epicml/16.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="16">
                  <img src="https://storage.googleapis.com/epicml/17.jpg" class="img-fluid box">
                </div>
                <div class="carousel-item" data-slide-number="17">
                  <img src="https://storage.googleapis.com/epicml/18.jpg" class="img-fluid box">
                </div>
                <!--
                                  <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                      <span class="sr-only">Previous</span>
                                  </a>
                                  <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                      <span class="sr-only">Next</span>
                                  </a>-->
              </div>

              <script>
                var painter_no = 1; //global variable
                    var englert=0;  //for showing painter info
              </script>


              <script> //for showing painter info
              function PainterImpr() {
                var x = document.getElementById("painter");

                if (englert ===1 ) {
                  x.style.display = "block";
                } else {
                  x.style.display = "none";
                }
              }
              </script>


              <script> // custom style
              function Custom_style_applied() {
                var y = document.getElementById("myCarousel");

                if (custom_style === 1 ) {
                  y.style.display = "none";
                  document.getElementById("own_style_box").style.display = "block";
                      document.getElementById("own_style_text").innerHTML = "Using your style";
                } else {
                  y.style.display = "block";
                }
              }




              </script>




              <div class="row list-inline mx-auto" style="margin-top:5px; padding:1px; margin-bottom:25px">
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item active">
                    <a id="carousel-selector-0" class="selected" data-slide-to="0" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/1.jpg" onclick="painter_no=1; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-1" data-slide-to="1" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/2.jpg" onclick="painter_no=2; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a> </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-2" data-slide-to="2" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/3.jpg" onclick="painter_no=3; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item">
                    <a id="carousel-selector-3" data-slide-to="3" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/4.jpg" onclick="painter_no=4; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-4" data-slide-to="4" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/5.jpg" onclick="painter_no=5; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-5" data-slide-to="5" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/6.jpg" onclick="painter_no=6; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-6" data-slide-to="6" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/7.jpg" onclick="painter_no=7; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-7" data-slide-to="7" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/8.jpg" onclick="painter_no=8; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-8" data-slide-to="8" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/9.jpg" onclick="painter_no=9; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-9" data-slide-to="9" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/10.jpg" onclick="painter_no=10; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-10" data-slide-to="10" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/11.jpg" onclick="painter_no=11; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>

                <div class="col-2" style="padding:0; margin:0px;">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-11" data-slide-to="11" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/12.jpg" onclick="painter_no=12; englert=0; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>




                <div class="col-2" style="padding:0; margin:0px; background-color:lightgrey">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-12" data-slide-to="12" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/13.jpg" onclick="painter_no=13; englert=1; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px; background-color:lightgrey">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-13" data-slide-to="13" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/14.jpg" onclick="painter_no=14; englert=1; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px; background-color:lightgrey">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-14" data-slide-to="14" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/15.jpg" onclick="painter_no=15; englert=1; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px; background-color:lightgrey">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-15" data-slide-to="15" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/16.jpg" onclick="painter_no=16; englert=1; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px; background-color:lightgrey">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-16" data-slide-to="16" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/17.jpg" onclick="painter_no=17; englert=1; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>
                <div class="col-2" style="padding:0; margin:0px; background-color:lightgrey">
                  <li class="list-inline-item ">
                    <a id="carousel-selector-17" data-slide-to="17" data-target="#myCarousel">
                      <img src="https://storage.googleapis.com/epicml/18.jpg" onclick="painter_no=18; englert=1; PainterImpr()" class="img-fluid thumb_box">
                    </a>
                  </li>
                </div>




                <div style="display:none; padding:0 0 0 3px; margin:0;" id="painter"><p style="padding:0 0 0 3px; margin:0;">Style by: <a href="https://www.instagram.com/evenglert/">EvEnglert</a> </p></div>




              </div>
            </div>

          </div>

          <div class="box" style="text-align:center;height:70px">
            <button type="button" class="btn btn-primary btn-lg" id="predict-button" style="">Transfer Style</button>
          </div>










          <script>
            var custom_style = 0;
            var custom_style_selected = false;

            //Select Style Image for Upload
            let base64Image_custom;
            base64Image_custom = 0;
            $("#style_selector").change(function() {
              let reader = new FileReader();
              custom_style_selected = true;
              reader.onload = function(e) {
                let dataURL = reader.result;
                //$('#selected_style').attr("src", dataURL);
                $('#selected_style2').attr("src", dataURL);

                base64Image_custom = dataURL.replace(/^data:image\/(png|jpeg);base64,/, "");
                custom_style = 1;

                Custom_style_applied();
              }
              //Displays image in html <img>
              reader.readAsDataURL($("#style_selector")[0].files[0]);
            });
          </script>










          <!-- RESULT BOX with FANCY COLORS -->
          <style media="screen">
            .boxx {
              display: flex;
              align-items: center;
              justify-content: center;
              width: 400px;
              height: 200px;
              color: white;
              font-family: 'Raleway';
              font-size: 2.5rem;
            }

            .gradient-border {
              --borderWidth: 3px;
              background: #1D1F20;

              position: relative;
              border-radius: var(--borderWidth);
            }

            .gradient-border:after {
              content: '';
              position: absolute;
              top: calc(-1 * var(--borderWidth));
              left: calc(-1 * var(--borderWidth));
              height: calc(100% + var(--borderWidth) * 2);
              width: calc(100% + var(--borderWidth) * 2);
              background: linear-gradient(60deg, #f79533, #f37055, #ef4e7b, #a166ab, #5073b8, #1098ad, #07b39b, #6fba82);
              border-radius: calc(2 * var(--borderWidth));
              z-index: -1;
              animation: animatedgradient 3s ease alternate infinite;
              background-size: 300% 300%;
            }

            @keyframes animatedgradient {
              0% {
                background-position: 0% 50%;
              }

              50% {
                background-position: 100% 50%;
              }

              100% {
                background-position: 0% 50%;
              }
            }
          </style>

          <div class="row gradient-border boxx" id="image_result_box" style=" height:auto; width:730px; margin:auto; margin-bottom:30px">
            <div class="col" style="text-align:center; padding:0px">
        <a id="download" download="FreeStyleTransfer.jpg" href="/path/to/image" title="FreeStyleTransfer">
                  <img id='img' src="" style="padding:10px; width:100%; height:100%;display:none">
        </a>



            </div>
          </div>

          <!-- PROGRESS BAR -->
          <style>
            /*Style -- Progress bar*/
            .loader {
              border: 16px solid #f3f3f3;
              /* Light grey */
              border-top: 16px solid #3498db;
              /* Blue */
              border-radius: 50%;
              width: 120px;
              height: 120px;
              margin-left: auto;
              margin-right: auto;
              animation: spin 2s linear infinite;
            }

            @keyframes spin {
              0% {
                transform: rotate(0deg);
              }

              100% {
                transform: rotate(360deg);
              }
            }
          </style>

          <!-- PROGRESS BAR -->
          <div class="box" id="loader_box" style="display:none; text-align:center;height:70px; margin:100px 0 100px 0">
            <div class="col text-center">
              <div class="loader" id="loader" style=" text-align:center"></div>
            </div>
          </div>
        </div>
      </div>
    </div>  <div class="sharethis-inline-share-buttons"></div>
  </div>


  </main>

  <script>

    var painter_no = 1;
    var image_selected = false;
    //Initiating FLASK APP
    //Select Image for Upload
    let base64Image;
    $("#image-selector").change(function() {
      let reader = new FileReader();
      image_selected = true;
      reader.onload = function(e) {
        let dataURL = reader.result;
        $('#selected-image').attr("src", dataURL);
        base64Image = dataURL.replace(/^data:image\/(png|jpeg);base64,/, "");
        //alert(base64Image);
      }
      //Displays image in html <img>
      reader.readAsDataURL($("#image-selector")[0].files[0]);
    });

    //UPLOAD IMAGE TO FLASK
    $("#predict-button").click(function(event) {

      if (image_selected == false) {
        alert("You need to upload a photo first.");
        return;
      };
      var image_loaded = 0;
      if (image_loaded == 0) {
        document.getElementById('image_result_box').style.display = "none";
      };

      var l = document.getElementById("loader_box");
      if (l.style.display === "none") {
        l.style.display = "block";
        document.getElementById('loader_box').scrollIntoView();
      };

      let message = {
        image: base64Image,
        painter: painter_no,
        custom_style: base64Image_custom
      }



      console.log(message);

      //Requesting the response of the @app.route("/predict", methods = ["POST"])
      //LOCALHOST needs to be changed for online use
      // /predict is the name of APP route point in the Python files
      $.post("http://localhost:5000/transfer", JSON.stringify(message), function(response) {

        //Console Log is for testing purpose only
        //console.log(response);

        // Setting the SRC attribute to the BASE64 + Response from the Neural Style APP
        document.getElementById('img')
          .setAttribute('src', 'data:image/png;base64,' + response);

          document.getElementById('download')
            .setAttribute('href', 'data:image/png;base64,' + response);

        image_loaded = 1;
        if (image_loaded == 1) {
          document.getElementById('image_result_box').style.display = "block";
          document.getElementById('loader_box').style.display = "none";
          document.getElementById('img').style.display = "block";
        };
      });
    });
  </script>
  <!-- Ending FLASK APP ---------------------------------------------------------------------->
  <!------------------------------------------------------------------------------------------>

  <!-- Bootstrap core JavaScript
    ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

  <!-- Footer -->
  <footer class="page-footer font-small blue" style="background-color:#E3DFDF">

    <!-- Copyright -->
    <div class="footer-copyright text-center py-3">Application provided by - <a href="https://epicml.net"><b> EpicML.net</b></a>



    </div>
    <!-- Copyright -->

  </footer>
</body>

</html>
