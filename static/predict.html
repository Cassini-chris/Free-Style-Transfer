<!DOCTYPE html>
<html lang="en">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Query is needed for the $.post method -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Free Style Transfer</title>


    <!-- Custom styles for this template -->

  </head>
  <body>

<style media="screen">
.masthead {
height: 100vh;
min-height: 500px;
background-image: url('https://storage.googleapis.com/epicml/4.jpg');
background-size: cover;
background-position: center;
background-repeat: no-repeat;
}
</style>


    <header class="masthead">
      <div class="container h-100">
        <div class="row h-100 align-items-center">
          <div class="col-12 text-center">
            <h1 class="font-weight-light">Vertically Centered Masthead Content</h1>
            <p class="lead">A great starter layout for a landing page</p>
          </div>
        </div>
      </div>
    </header>

  <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
    <a class="navbar-brand" href="#">Navbar</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="#">Link</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Link</a>
        </li>
      </ul>
    </div>
  </nav>


  <div class="container">
      <div class="row">
        <h1 class="display-2">Try it yourself!</h1>
      </div>

      <div class="row" style="background-color:grey">
        <span>Your Image</span>
        <input id ="image-selector" type="file"/>
      </div>

      <div class="row">
         <div style="padding:10px; text-align: center;">
          <img id="selected-image" src="" width="300" height="300"/>
         </div>
      </div>

      <div class="row">
       <h1 class="display-2">Choose your Style</h1>
      </div>

      <div class="row">
        <img class="mySlides" src="https://storage.googleapis.com/epicml/2.jpg" style="width:100%">
      </div>

      <div class="row" style="background-color:grey">
        <button id="predict-button">Transfer Style</button>
      </div>

      <div class="row" style="background-color:grey">
          <img id='img' src="" style="width:100%">
      </div>

        </div>
      </div>


      <style media="screen">
        #myCarousel .list-inline {
          white-space:nowrap;
          overflow-x:auto;
      }

      #myCarousel .carousel-indicators {
          position: static;
          left: initial;
          width: initial;
          margin-left: initial;
      }

      #myCarousel .carousel-indicators > li {
          width: initial;
          height: initial;
          text-indent: initial;
      }

      #myCarousel .carousel-indicators > li.active img {
          opacity: 0.7;
      }
      </style>
      <div class="container py-2">
          <div class="row min-vh-100 align-items-center">
              <div class="col-lg-8 offset-lg-2" id="slider">
                  <div id="myCarousel" class="carousel slide shadow">
                      <!-- main slider carousel items -->
                      <div class="carousel-inner">
                          <div class="active carousel-item" data-slide-number="0">
                              <img src="http://placehold.it/1200x480&amp;text=one" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="1">
                              <img src="http://placehold.it/1200x480/888/FFF" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="2">
                              <img src="http://placehold.it/1200x480&amp;text=three" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="3">
                              <img src="http://placehold.it/1200x480&amp;text=four" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="4">
                              <img src="http://placehold.it/1200x480&amp;text=five" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="5">
                              <img src="http://placehold.it/1200x480&amp;text=six" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="6">
                              <img src="http://placehold.it/1200x480&amp;text=seven" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="7">
                              <img src="http://placehold.it/1200x480&amp;text=eight" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="8">
                              <img src="http://placehold.it/1200x480&amp;text=seven" class="img-fluid">
                          </div>
                          <div class="carousel-item" data-slide-number="9">
                              <img src="http://placehold.it/1200x480&amp;text=eight" class="img-fluid">
                          </div>

                          <a class="carousel-control-prev" href="#myCarousel" role="button" data-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="sr-only">Previous</span>
                          </a>
                          <a class="carousel-control-next" href="#myCarousel" role="button" data-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="sr-only">Next</span>
                          </a>

                      </div>
                      <!-- main slider carousel nav controls -->


                      <ul class="carousel-indicators list-inline mx-auto border px-2">
                          <li class="list-inline-item active">
                              <a id="carousel-selector-0" class="selected" data-slide-to="0" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=one" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-1" data-slide-to="1" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=two" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-2" data-slide-to="2" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=three" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-3" data-slide-to="3" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=four" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-4" data-slide-to="4" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=five" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-5" data-slide-to="5" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=six" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-6" data-slide-to="6" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=seven" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-7" data-slide-to="7" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=eight" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-6" data-slide-to="8" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=seven" class="img-fluid">
                              </a>
                          </li>
                          <li class="list-inline-item">
                              <a id="carousel-selector-7" data-slide-to="9" data-target="#myCarousel">
                                  <img src="http://placehold.it/80x60&amp;text=eight" class="img-fluid">
                              </a>
                          </li>

                      </ul>
                  </div>
              </div>

          </div>
          <!--/main slider carousel-->
      </div>

    </main>

    <script>
    var painter_no = 1;
    <!------------------------------------------------------------------------------------------>
    <!-- Initiating FLASK APP ------------------------------------------------------------------>

    //Select Image for Upload
    let base64Image;
    $("#image-selector").change(function() {
      let reader = new FileReader();
      reader.onload = function(e) {
      let dataURL = reader.result;
       $('#selected-image').attr("src", dataURL);
        base64Image= dataURL.replace(/^data:image\/(png|jpeg);base64,/, "");
        //alert(base64Image);
    }
    //Displays image in html <img>
    reader.readAsDataURL($("#image-selector")[0].files[0]);
    });

    //UPLOAD IMAGE TO FLASK
    $("#predict-button").click(function(event){
           alert("Encoding of Image  --> Decode --> ML prediction --> Sending new Image back to HTML");


    let message = {image: base64Image,
                   painter: painter_no
                  }
    console.log(message);

    //Requesting the response of the @app.route("/predict", methods = ["POST"])
    //LOCALHOST needs to be changed for online use
    // /predict is the name of APP route point in the Python files
    $.post("http://localhost:5000/predict", JSON.stringify(message), function(response){

      //Console Log is for testing purpose only
      //console.log(response);

      // Setting the SRC attribute to the BASE64 + Response from the Neural Style APP
      document.getElementById('img')
          .setAttribute('src', 'data:image/png;base64,' + response);
    });
    });
    </script>
    <!-- Ending FLASK APP ---------------------------------------------------------------------->
    <!------------------------------------------------------------------------------------------>



    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->



    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
      <img id='img' src="" style="width:100%">
      </div>
  </body>
</html>
